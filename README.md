# 🚀 تسک برنامه‌نویس بک‌اند لاراول

## 🎯 هدف  
ارزیابی توانایی برنامه‌نویس در استفاده بهینه از **Eloquent ORM** برای ایجاد APIهای تمیز، ساختارمند و بهینه، با تمرکز بر استفاده از **JOIN در Eloquent** و **Eager Loading**.

---

## 📝 توضیحات تسک  
لطفاً یک API در لاراول توسعه دهید که قابلیت‌های زیر را داشته باشد:

1. **ایجاد (POST)** یک پکیج مسافرتی با اعتبارسنجی مناسب.
2. **دریافت (GET)** لیست پکیج‌های مسافرتی همراه با جزئیات رزروها با استفاده از **JOIN** در Eloquent و **Eager Loading**.
3. پاسخ‌ها باید در قالب **JSON** بازگردانده شوند.
4. اطلاعات باید در پایگاه‌داده ذخیره شوند.
5. مستند موجود در [این لینک](https://platform.neshan.org/api/reverse-geocoding/) را مطالعه کرده و در برنامه یک endpoint بسازید که:
   - مختصات ثابت `lat=35.6892` و `lng=51.3890` را به سرویس ارسال کند.
   - خروجی دریافتی را در قالب یک فایل متنی با نام `output.json` در **ریشه پروژه** (`base_path()`) ذخیره کند.
   - از API Key زیر استفاده شود:

     ```
     service.515c4e65c6284d9bb3c7a5120c03f960
     ```

6. **توجه:** نیازی به پیاده‌سازی API مجزا برای ثبت یا مدیریت رزروها (Booking) نیست. فقط کافی است اطلاعات رزروها از طریق ارتباط با مدل `TravelPackage` نمایش داده شود.
7. **تسک اختیاری:** نوشتن یونیت تست برای یک یا چند کنترلر/سرویس (مثلاً: TravelPackageController یا GeoService) امتیاز ویژه دارد.

---

## 🗃️ ساختار پایگاه‌داده (MySQL)

### جدول travel_packages

- `id` (کلید اصلی)
- `name` (رشته) - نام پکیج (مثلاً "تور استانبول")
- `price` (اعشاری) - قیمت پکیج
- `location` (رشته) - مقصد
- `created_at` و `updated_at` (تاریخ و زمان)

### جدول bookings

- `id` (کلید اصلی)
- `package_id` (کلید خارجی → travel_packages)
- `customer_name` (رشته)
- `customer_email` (رشته)
- `travel_date` (تاریخ)
- `created_at` و `updated_at` (تاریخ و زمان)

---

## 💡 الزامات

- استفاده از **Eloquent ORM** (بدون استفاده از کوئری‌های SQL خام).
- تعریف روابط در مدل‌ها:
  - در مدل `TravelPackage` متد `bookings()` برای ارتباط یک به چند.
  - در مدل `Booking` متد `travelPackage()` برای ارتباط بلعکس.
- استفاده از `with` و `withCount` برای Eager Loading و بهینه‌سازی کوئری‌ها.
- متد GET باید اطلاعات زیر را بازگرداند:
  - نام پکیج، قیمت، مقصد
  - تعداد رزروها (`total_bookings`)
  - مشخصات مسافران (نام و ایمیل) - از طریق JOIN در Eloquent
- اگر پکیجی رزروی نداشته باشد، مقدار `customers` باید آرایه خالی `[]` باشد.

---

## 🟢 نمونه خروجی مورد انتظار

```json
[
  {
    "id": 1,
    "name": "تور استانبول",
    "price": 1200,
    "location": "ترکیه",
    "total_bookings": 3,
    "customers": [
      { "customer_name": "علی رضایی", "customer_email": "ali@example.com" },
      { "customer_name": "زهرا احمدی", "customer_email": "zahra@example.com" }
    ]
  }
]
